<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Puzle RGB - Tutorial</title>
  <style>
    body {
      background: #fff;
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }
    h1 {
      font-size: 24px;
      margin-bottom: 20px;
    }
    canvas {
      border: 1px solid #ccc;
      image-rendering: pixelated;
    }
    .controls {
      margin-top: 15px;
    }
    button {
      margin: 0 5px;
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      background: #eee;
      cursor: pointer;
    }
    button.active {
      background: #000;
      color: #fff;
    }
    #message {
      margin-top: 15px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Tutorial: Filtros de color RGB</h1>
  <canvas id="panel" width="250" height="250"></canvas>
  <div class="controls">
    <button id="r" class="active">R</button>
    <button id="g" class="active">G</button>
    <button id="b" class="active">B</button>
  </div>
  <div id="message"></div>
  
  <script>
    const canvas = document.getElementById('panel');
    const ctx = canvas.getContext('2d');
    const size = 5;
    const cellSize = 50;
    const path = [ [0,0], [1,0], [2,0], [2,1], [2,2], [3,2], [4,2], [4,3], [4,4] ];

    const grid = [];
    const filters = { r: true, g: true, b: true };

    // Generar grid con mezcla de colores
    for (let y = 0; y < size; y++) {
      grid[y] = [];
      for (let x = 0; x < size; x++) {
        const inPath = path.some(([px, py]) => px === x && py === y);
        if (inPath) {
          // Color visible con filtros adecuados
          const color = [255, 0, 255]; // Magenta: rojo + azul
          grid[y][x] = color;
        } else {
          const r = Math.random() < 0.5 ? 255 : 0;
          const g = Math.random() < 0.5 ? 255 : 0;
          const b = Math.random() < 0.5 ? 255 : 0;
          grid[y][x] = [r, g, b];
        }
      }
    }

    function applyFilters(color) {
      return [
        filters.r ? color[0] : 0,
        filters.g ? color[1] : 0,
        filters.b ? color[2] : 0
      ];
    }

    function draw() {
      for (let y = 0; y < size; y++) {
        for (let x = 0; x < size; x++) {
          const filtered = applyFilters(grid[y][x]);
          ctx.fillStyle = `rgb(${filtered[0]},${filtered[1]},${filtered[2]})`;
          ctx.fillRect(x * cellSize, y * cellSize, cellSize, cellSize);
        }
      }
    }

    function checkVictory() {
      const currentColor = applyFilters([255,0,255]);
      if (currentColor[0] === 255 && currentColor[1] === 0 && currentColor[2] === 255) {
        document.getElementById('message').innerText = "Â¡Correcto! Has revelado el camino magenta.";
      } else {
        document.getElementById('message').innerText = "Activa los filtros correctos para ver el camino.";
      }
    }

    draw();
    checkVictory();

    document.getElementById('r').addEventListener('click', () => {
      filters.r = !filters.r;
      document.getElementById('r').classList.toggle('active');
      draw();
      checkVictory();
    });
    document.getElementById('g').addEventListener('click', () => {
      filters.g = !filters.g;
      document.getElementById('g').classList.toggle('active');
      draw();
      checkVictory();
    });
    document.getElementById('b').addEventListener('click', () => {
      filters.b = !filters.b;
      document.getElementById('b').classList.toggle('active');
      draw();
      checkVictory();
    });
  </script>
</body>
</html>
